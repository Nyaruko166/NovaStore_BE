<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{admin/admin-layout.html}">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div layout:fragment="content">
    <div class="col">
        <div class="card">
            <div class="card-header">
                <h5 style="font-weight: bold">CẬP NHẬT CHI TIẾT SẢN PHẨM</h5>
            </div>
            <div class="card-body card-block">
                <form th:object="${createProductDetailForm}" th:method="post" th:action="@{/nova/product-detail/update}"
                      id="productDetailUpdate" class="form-horizontal"
                      enctype="multipart/form-data">
                    <div class="form-detail">
                        <div class="form-table " th:each="productDetail, iterStat : *{listProductDetail}">
<!--                            <input hidden th:field="*{listProductDetail[__${iterStat.index}__].code}">-->
                            <div class="row form-row" th:id="${'form-row-' + productDetail.id}">
                                <div class="form-group col-2">
                                    <label class="font-weight-bold">Mã chi tiết</label>
                                    <input type="text" class="form-control code-select"
                                           th:field="*{listProductDetail[__${iterStat.index}__].code}" readonly required>
                                </div>
                                <div class="form-group col-2">
                                    <label class="font-weight-bold">Số lượng</label>
                                    <input type="number" class="form-control productDetail-quantity" min="0" value="1"
                                           th:field="*{listProductDetail[__${iterStat.index}__].quantity}">
                                </div>
                                <div class="form-group col-2">
                                    <label class="font-weight-bold">Giá tiền</label>
                                    <input type="number" class="form-control productDetail-price" min="0" value="0"
                                           th:field="*{listProductDetail[__${iterStat.index}__].price}">
                                </div>
                                <div class="form-group col-2">
                                    <label class="font-weight-bold">Màu sắc</label>
                                    <select class="form-control color-select"
                                            th:field="*{listProductDetail[__${iterStat.index}__].color}">
                                        <option th:value="${color.id}" th:each="color: ${listColor}"
                                                th:text="${color.name}" th:data-code="${color.code}">
                                        </option>
                                    </select>
                                </div>
                                <div class="form-group col-2">
                                    <label class="font-weight-bold">Kích cỡ</label>
                                    <select class="form-control size-select"
                                            th:field="*{listProductDetail[__${iterStat.index}__].size}">
                                        <option th:value="${size.id}" th:each="size: ${listSize}"
                                                th:text="${size.name}" th:data-code="${size.code}">
                                        </option>
                                    </select>
                                </div>
                                <div>
                                    <button type="button" class="btn btn-danger remove-row" style="margin-top: 32px">
                                        <i class="fa fa-trash" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <br>
                    <div class="card-footer d-flex align-items-center">
                        <button type="button" onclick="addItem()" class="btn btn-dark">
                            <i class="fa-solid fa-file-circle-plus px-4"></i>
                        </button>
                        <div id="error" style="color: red; margin-left: 10px">

                        </div>
                    </div>
                    <br>
                    <div class="card-footer d-flex align-items-center">
                        <div class="form-section">
                            <div class="d-flex">
                                <div class="title title-name-product mr-3">Hình ảnh</div>
                                <div id="errorImage" style="color: red">

                                </div>
                            </div>

                            <label class="control-label">
                                Chọn 1 hoặc nhiều hình ảnh
                            </label>
                            <div class="image-group d-flex">
                                <div class="selected-files row" id="selected-images">
                                    <div th:each="items : ${listImage}" class="selected-file me-2">
                                        <div class="file-details">
                                            <button class="btn btn-sm btn-outline-danger rounded-circle delete-img-btn"
                                                    type="button"
                                            >X
                                            </button>
                                        </div>
                                        <img class="exists-image" th:src="@{'/image/' + ${items.id}}"
                                             alt="Selected Image" width="100" height="120" th:data-image="${items.id}">

                                    </div>
                                </div>
                                <div class="image-upload" style="margin-left: 20px">
                                    <label for="file-input" class="label-select-img">
                                        <i class="fa fa-plus"></i>
                                    </label>
                                    <input id="file-input" type="file" multiple
                                           accept="image/png, image/jpg, image/jpeg"
                                           oninput="onInputText('errorImage')"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <div class="card-footer d-flex">
                        <div>
                            <button type="submit" onclick="" class="btn btn-dark">
                                <i class="fa-solid fa-pen px-4"></i>
                            </button>
                        </div>
                        <div class="ml-2">
                            <a th:href="@{|/nova/product/${productId}/view-update|}">
                                <button type="button" class="btn btn-warning">
                                    <i class="fa-solid fa-circle-left px-4"></i>
                                </button>
                            </a>
                        </div>
                    </div>
                    <script th:inline="javascript">

                        // Không cho nhập dấu trừ
                        function onlyAllowNumberInput(e) {
                            const key = e.key;
                            if (key === '-') {
                                e.preventDefault();
                            }
                        }

                        // Không cho nhập chữ
                        function onlyAllowNumberInput2(e) {
                            const key = e.key;
                            if (!/[\d\b]/.test(key)) {
                                e.preventDefault();
                            }
                        }

                        $('.productDetail-quantity').on('keydown', function (e) {
                            onlyAllowNumberInput(e)
                        })
                        $('.productDetail-quantity').on('input change', function (e) {
                            if ($(this).val() < 0) {
                                $(this).val(0)
                            }
                        })
                        $('.productDetail-quantity').on('focusout', function (e) {
                            if ($(this).val() == "") {
                                $(this).val(0)
                            }
                        })

                        // $('.productDetail-price').on('keydown', function (e) {
                        //     onlyAllowNumberInput2(e)
                        // })

                        // $('.productDetail-price').on('focusout', function (e) {
                        //     if ($(this).val() == "") {
                        //         $(this).val(0)
                        //     }
                        // })


                        // Khoi tao list detail color and size hiện tại để chuẩn bị cho việc check trùng size và color
                        var listDetail = []

                        document.querySelectorAll(".form-row").forEach(item => {
                            var color = item.querySelector('.color-select').value;
                            var size = item.querySelector('.size-select').value;
                            listDetail.push({
                                color: color,
                                size: size
                            })
                        })

                        var previousColorValue
                        $('.color-select').on('click', function () {
                            // Lưu giá trị hiện tại khi phần tử nhận sự tập trung (focus)
                            previousColorValue = $(this).val();
                        }).on('change', function () {
                            var currentValue = $(this).val();
                            var currentSize = $(this).closest('.form-row').find('.size-select').val();
                            if (checkDuplidateExists(currentValue, currentSize)) {
                                $(this).val(previousColorValue)

                            } else {
                                listDetail = listDetail.filter(item => item.color !== previousColorValue || item.size !== currentSize)
                                listDetail.push({
                                    color: currentValue,
                                    size: currentSize
                                })
                            }
                        });

                        var previousSizeValue
                        $('.size-select').on('click', function () {
                            // Lưu giá trị hiện tại khi phần tử nhận sự tập trung (focus)
                            previousSizeValue = $(this).val();
                        }).on('change', function () {
                            var currentValue = $(this).val();
                            var currentColor = $(this).closest('.form-row').find('.color-select').val();
                            if (checkDuplidateExists(currentColor, currentValue)) {
                                $(this).val(previousSizeValue)

                            } else {
                                listDetail = listDetail.filter(item => item.color !== currentColor || item.size !== previousSizeValue)
                                listDetail.push({
                                    color: currentColor,
                                    size: currentValue
                                })
                            }
                        });

                        function checkDuplidateExists(color, size) {
                            var isdup = false
                            listDetail.forEach(item => {
                                if (item.color == color && item.size == size) {
                                    const Toast = Swal.mixin({
                                        toast: true,
                                        position: "top-end",
                                        showConfirmButton: false,
                                        timer: 3000,
                                        timerProgressBar: true,
                                        didOpen: (toast) => {
                                            toast.onmouseenter = Swal.stopTimer;
                                            toast.onmouseleave = Swal.resumeTimer;
                                        },
                                        customClass: {
                                            popup: 'swal2-popup-error', // Lớp CSS tùy chỉnh cho hộp thoại
                                            title: 'swal2-title-error', // Lớp CSS tùy chỉnh cho tiêu đề
                                            icon: 'swal2-icon-error', // Lớp CSS tùy chỉnh icon
                                            timerProgressBar: 'swal2-timer-progress-bar-error' //Lớp CSS tùy chỉnh thời gian chạy
                                        }
                                    });
                                    Toast.fire({
                                        icon: "error",
                                        title: "Không được chọn trùng màu sắc và kích cỡ !"
                                    });
                                    isdup = true
                                    return
                                }
                            })
                            return isdup
                        }


                        //XỬ LÝ THÊM THUỘC TÍNH
                        // bắt sự kiện xóa ảnh
                        var removeImageId = []
                        $('.delete-img-btn').on('click', function () {
                            const selectedImageEle = $(this).closest('.selected-file')
                            removeImageId.push(selectedImageEle.find('.exists-image').attr("data-image"))
                            selectedImageEle.remove()
                        })

                        var removeProductDetail = []
                        function addEventRemoveRow() {
                            $('.remove-row').on('click', function (e) {
                                let id = getRowId(e)
                                if (id) removeProductDetail.push(id)
                                const selectedProductDetail = $(this).closest('.form-table')
                                // removeProductDetail.push(selectedProductDetail.find('.form-row').attr("data-image"))
                                selectedProductDetail.remove()
                                debugger
                            })
                        }
                        function getRowId(e) {
                            let id = e.currentTarget.parentElement.parentElement.id
                            if (id) {
                                return id.replaceAll('form-row-', '')
                            }
                            return null
                        }
                        addEventRemoveRow()


                        function addItem() {
                            // var detailId = detail.id + 1;
                            var template = document.querySelector('.form-table').cloneNode(true);
                            var formRows = template.querySelectorAll('.form-row');
                            formRows.forEach(e => {e.id = ''})
                            // numberical++
                            // Update the index to ensure uniqueness for the new product detail
                            var newIndex = document.querySelectorAll('.form-table').length;

                            // Update the names of input fields to ensure uniqueness
                            template.querySelectorAll('input, select').forEach(function (input) {
                                var name = input.getAttribute('name');
                                if (name) {
                                    input.setAttribute('name', name.replace('listProductDetail[0]', 'listProductDetail[' + newIndex + ']'));
                                    input.value = ''; // Clear input values if needed
                                }
                            });

                            template.querySelector('.productDetail-price').value = 1000
                            template.querySelector('.productDetail-quantity').value = 1

                            $('.productDetail-quantity').on('keydown', function (e) {
                                onlyAllowNumberInput(e)
                            })
                            $('.productDetail-quantity').on('input change', function (e) {
                                if ($(this).val() < 0) {
                                    $(this).val(0)
                                }
                            })
                            $('.productDetail-quantity').on('focusout', function (e) {
                                if ($(this).val() == "") {
                                    $(this).val(0)
                                }
                            })
                            // const deleteButtonContainer = document.createElement('div')
                            // const deleteButton = document.createElement('button');
                            // deleteButton.type = 'button';
                            // deleteButton.classList.add('btn', 'btn-danger');
                            // deleteButton.style.marginTop = '32px'
                            // deleteButton.innerHTML = '<i class="fa fa-trash" aria-hidden="true"></i>';
                            // deleteButtonContainer.appendChild(deleteButton)
                            //
                            // template.querySelector('.form-row').appendChild(deleteButtonContainer)

                            document.querySelector('.form-detail').appendChild(template);
                            var color = ''
                            var size = ''
                            template.querySelector(".color-select").addEventListener('change', function (e) {
                                color = e.target.value
                                if (!checkDuplicateSizeAndColor(color, size, template) && color != '' && template.querySelector(".size-select").value != '') {
                                    listDetail.push({
                                        color: color,
                                        size: size
                                    })
                                }
                            })

                            template.querySelector(".size-select").addEventListener('change', function (e) {
                                size = e.target.value
                                if (!checkDuplicateSizeAndColor(color, size, template) && size != '' && template.querySelector(".color-select").value != '') {
                                    listDetail.push({
                                        color: color,
                                        size: size
                                    })
                                }

                            })
                            addEventRemoveRow()

                            // deleteButton.onclick = function (e) {
                            //     debugger
                            //     document.querySelector('.form-row').removeChild(template)
                            //     removeDetailObj(color, size)
                            // }

                        }



                        function removeDetailObj(color, size) {

                            listDetail = listDetail.filter(function (obj) {
                                return obj.color !== color || obj.size !== size;
                            });
                        }

                        function checkDuplicateSizeAndColor(color, size, template) {
                            listDetail.forEach(item => {
                                if (item.color == color && item.size == size) {
                                    document.querySelector('.form-detail').removeChild(template)
                                    const Toast = Swal.mixin({
                                        toast: true,
                                        position: "top-end",
                                        showConfirmButton: false,
                                        timer: 3000,
                                        timerProgressBar: true,
                                        didOpen: (toast) => {
                                            toast.onmouseenter = Swal.stopTimer;
                                            toast.onmouseleave = Swal.resumeTimer;
                                        },
                                        customClass: {
                                            popup: 'swal2-popup-error', // Lớp CSS tùy chỉnh cho hộp thoại
                                            title: 'swal2-title-error', // Lớp CSS tùy chỉnh cho tiêu đề
                                            icon: 'swal2-icon-error', // Lớp CSS tùy chỉnh icon
                                            timerProgressBar: 'swal2-timer-progress-bar-error' //Lớp CSS tùy chỉnh thời gian chạy
                                        }
                                    });
                                    Toast.fire({
                                        icon: "error",
                                        title: "Không được chọn trùng màu sắc và kích cỡ !"
                                    });
                                    return true
                                }
                            })
                            return false
                        }

                        //Handle file input
                        const fileInput = document.getElementById("file-input")
                        fileInput.addEventListener('change', (e) => displaySelectedImages(e))
                        const selectedFileNames = new Set();
                        var fileSend = [];

                        function displaySelectedImages(event) {
                            const selectedImagesContainer = document.getElementById('selected-images');

                            const files = event.target.files;

                            for (let i = 0; i < files.length; i++) {
                                const file = files[i];

                                // Check if the selected file is an image
                                if (file.type.startsWith('image/')) {
                                    const fileSizeInMB = file.size / (1024 * 1024);
                                    if (fileSizeInMB > 3) {
                                        // Swal.fire("Lỗi", "Vui lòng chọn ảnh có dung lượng < 3MB")
                                        document.getElementById('errorImage').innerHTML = 'Vui lòng chọn ảnh có dung lượng < 3MB'
                                    } else {
                                        const fileName = file.name
                                        if (!selectedFileNames.has(fileName)) {
                                            fileSend.push(file);
                                            const reader = new FileReader();

                                            reader.onload = function (e) {
                                                // Create a new div for the image
                                                const imageDiv = document.createElement('div');
                                                imageDiv.className = 'selected-file me-2';

                                                // Create an image element
                                                const image = document.createElement('img');
                                                image.src = e.target.result;
                                                image.alt = 'Selected Image';
                                                image.width = 110;
                                                image.height = 120;

                                                // Create a div for file details


                                                // Create a button to remove the image
                                                const removeButton = document.createElement('button');
                                                removeButton.className = 'btn btn-sm btn-outline-danger rounded-circle';
                                                removeButton.type = 'button';
                                                removeButton.innerText = 'X';
                                                removeButton.onclick = function () {
                                                    // Remove the selected image when the button is clicked
                                                    selectedImagesContainer.removeChild(imageDiv);
                                                };
                                                const fileDetailsDiv = document.createElement('div');
                                                fileDetailsDiv.className = 'file-details';
                                                // Append the image and remove button to the div
                                                fileDetailsDiv.appendChild(removeButton);
                                                imageDiv.appendChild(fileDetailsDiv);
                                                imageDiv.appendChild(image);

                                                // Append the image div to the selectedImagesContainer
                                                selectedImagesContainer.appendChild(imageDiv);
                                            };

                                            reader.readAsDataURL(file);
                                        }
                                    }

                                }
                            }
                        }

                        document.getElementById("productDetailUpdate").addEventListener('submit', async function (e) {
                            e.preventDefault()
                            // if (fileSend.length < 1) {
                            //     // Swal.fire('Lỗi', "Vui lòng chọn ít nhất một hình ảnh", "error")
                            //     document.getElementById('errorImage').innerHTML = 'Vui lòng chọn nhất 1 ảnh'
                            //     return
                            // }
                            var canAdd = true
                            $('.color-select').each(function (index, item) {
                                console.log($(item).val())
                                if ($(item).val() == null) {
                                    // Swal.fire("Lỗi", "Vui lòng chọn màu cho sản phẩm");
                                    document.getElementById('error').innerHTML = 'Vui lòng chọn màu cho sản phẩm'
                                    canAdd = false;
                                    return false; // To break out of the loop
                                }
                            });

                            $('.size-select').each(function (index, item) {
                                if ($(item).val() == null) {
                                    // swal("Lỗi", "Vui lòng chọn kích cỡ cho sản phẩm");
                                    document.getElementById('error').innerHTML = 'Vui lòng chọn kích cỡ cho sản phẩm'
                                    canAdd = false;
                                    return false; // To break out of the loop
                                }
                            });
                            if (!canAdd) {
                                return false
                            }


                            Swal.fire({
                                title: "Sửa dữ liệu",
                                text: "Bạn có muốn sửa dữ liệu không ?",
                                icon: "question",
                                showCancelButton: true,
                                confirmButtonColor: "#0DC149",
                                cancelButtonColor: "#d33",
                                confirmButtonText: "Có",
                                cancelButtonText: "Không",
                                allowOutsideClick: false
                            }).then(async (add) => {
                                if (add.isConfirmed) {
                                    var formData = new FormData(this)
                                    formData.append("imageRemoveIds", removeImageId)
                                    formData.append("productDetailRemoveIds", removeProductDetail)
                                    if (fileSend.length > 0) {
                                        fileSend.forEach(file => formData.append("files", file))
                                    }
                                    await fetch("/nova/product-detail/update", {
                                        method: "POST",
                                        body: formData,
                                    })
                                    window.location = "/nova/product/page";
                                    // document.getElementById('productDetailUpdate').action = '/nova/product/page'
                                    // document.getElementById('productDetailUpdate').method = 'get'
                                    // document.getElementById('productDetailUpdate').submit()
                                }
                            });

                        })

                    </script>
                </form>
                <script src="https://code.jquery.com/jquery-3.7.1.min.js"
                        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
                        crossorigin="anonymous"></script>
                <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
                <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"
                        th:inline="javascript"></script>
            </div>
        </div>
    </div>
</div>
</body>
</html>


<!--<!DOCTYPE html>-->
<!--<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"-->
<!--      layout:decorate="~{admin/admin-layout.html}">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <title>Cart Detail </title>-->
<!--</head>-->
<!--<body>-->
<!--<div layout:fragment="content">-->
<!--    <div class="col">-->
<!--        <div class="card">-->
<!--            <div class="card-header">-->
<!--                <h5 style="font-weight: bold">CẬP NHẬT CHI TIẾT SẢN PHẨM</h5>-->
<!--            </div>-->
<!--            <div th:if="${mess}">-->
<!--                <button hidden id="btnSuccess" th:onclick="alertSuccess([[${mess}]])">Click Me</button>-->
<!--                <script th:inline="javascript">-->
<!--                    window.onload = function () {-->
<!--                        var btnSuccess = document.getElementById("btnSuccess");-->
<!--                        btnSuccess.click();-->
<!--                    }-->
<!--                    alertSuccess = (content) => {-->
<!--                        Swal.fire({-->
<!--                            title: content,-->
<!--                            icon: "success",-->
<!--                            confirmButtonColor: "#0DC149"-->
<!--                        });-->
<!--                    }-->
<!--                </script>-->
<!--            </div>-->
<!--            <div th:if="${error}">-->
<!--                <button hidden id="btnError" th:onclick="alertError([[${error}]])">Click Me</button>-->
<!--                <script th:inline="javascript">-->
<!--                    window.onload = function () {-->
<!--                        var btnError = document.getElementById("btnError");-->
<!--                        btnError.click();-->
<!--                    }-->
<!--                    alertError = (content) => {-->
<!--                        Swal.fire({-->
<!--                            title: "Thêm dữ liệu thất bại",-->
<!--                            text: content,-->
<!--                            icon: "error",-->
<!--                            confirmButtonColor: "#d33"-->
<!--                        });-->
<!--                    }-->
<!--                </script>-->
<!--            </div>-->
<!--            <div class="card-body card-block">-->
<!--                <form id="productDetailUpdate" th:object="${productDetail}"-->
<!--                      th:action="@{/nova/product-detail/update/{id}(id=${productDetail.id})}"-->
<!--                      method="post" class="form-horizontal" enctype="multipart/form-data">-->

<!--                    <input type="hidden" class="form-control" th:value="*{product.id}" name="productId">-->

<!--                    <div class="mb-3">-->
<!--                        <div class="d-flex justify-content-between">-->
<!--                            <label class="font-weight-bold form-control-label">Mã sản phẩm-->
<!--                            </label>-->
<!--                        </div>-->
<!--                        <input type="text" class="form-control" th:value="*{product.code}" disabled>-->
<!--                    </div>-->

<!--                    <div class="mb-3">-->
<!--                        <div class="d-flex justify-content-between">-->
<!--                            <label class="font-weight-bold form-control-label">Tên sản phẩm-->
<!--                            </label>-->
<!--                        </div>-->
<!--                        <input type="text" class="form-control" th:value="*{product.name}" disabled>-->
<!--                    </div>-->

<!--                    <div class="mb-3">-->
<!--                        <div class="d-flex justify-content-between">-->
<!--                            <label class="font-weight-bold form-control-label">Mã chi tiết-->
<!--                            </label>-->
<!--                        </div>-->
<!--                        <input type="text" class="form-control" name="code" th:value="*{code}" disabled>-->
<!--                    </div>-->

<!--                    <div class="mb-3">-->
<!--                        <div class="d-flex justify-content-between">-->
<!--                            <label class="font-weight-bold form-control-label">Số lượng-->
<!--                            </label>-->
<!--                            <div class="" style="color: red" id="errorQuantity"></div>-->
<!--                        </div>-->
<!--                        <input type="number" class="form-control" id="quantity" name="quantity" th:value="*{quantity}"-->
<!--                               oninput="onInputText('errorQuantity')">-->
<!--                    </div>-->


<!--                    <div class="mb-3">-->
<!--                        <div class="d-flex justify-content-between">-->
<!--                            <label class="font-weight-bold form-control-label">Giá-->
<!--                            </label>-->
<!--                            <div class="" style="color: red" id="errorPrice"></div>-->
<!--                        </div>-->
<!--                        <input type="number" class="form-control" id="price" name="price"-->
<!--                               th:value="*{price}" oninput="onInputText('errorPrice')">-->
<!--                    </div>-->


<!--                    <div class="mb-3">-->
<!--                        <label class="font-weight-bold">Kích cỡ</label>-->
<!--                        <div class="w-100 d-flex justify-content-between">-->
<!--                            <div class="w-95">-->
<!--                                <select class="form-control" name="sizeId">-->
<!--                                    <option th:value="${size.id}" th:each="size: ${listSize}"-->
<!--                                            th:text="${size.name}" th:selected="(*{size.id} == ${size.id})"></option>-->
<!--                                </select>-->
<!--                            </div>-->
<!--                            <div class="w-5 d-flex justify-content-end">-->
<!--                                <button type="button" class="btn btn-dark" data-toggle="modal"-->
<!--                                        data-target="#exampleModalSize">-->
<!--                                    <i class="fa-solid fa-square-plus"></i>-->
<!--                                </button>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->


<!--                    <div class="mb-3">-->
<!--                        <label class="font-weight-bold">Màu sắc</label>-->
<!--                        <div class="w-100 d-flex justify-content-between">-->
<!--                            <div class="w-95">-->
<!--                                <select class="form-control" name="colorId">-->
<!--                                    <option th:value="${color.id}" th:each="color: ${listColor}"-->
<!--                                            th:text="${color.name}" th:selected="(*{color.id} == ${color.id})"></option>-->
<!--                                </select>-->
<!--                            </div>-->
<!--                            <div class="w-5 d-flex justify-content-end">-->
<!--                                <button type="button" class="btn btn-dark" data-toggle="modal"-->
<!--                                        data-target="#exampleModalColor">-->
<!--                                    <i class="fa-solid fa-square-plus"></i>-->
<!--                                </button>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->


<!--                    <div class="card-footer">-->
<!--                        <button onclick="updateProductDetail()" type="button" class="btn btn-dark"><i-->
<!--                                class="fa-solid fa-pen px-4"></i>-->
<!--                        </button>-->
<!--                        <script th:inline="javascript">-->

<!--                            checkQuantity = () => {-->
<!--                                let quantity = document.getElementById('quantity').value-->
<!--                                if (quantity === "") {-->
<!--                                    document.getElementById('errorQuantity').innerHTML = `Chưa nhập số lượng`-->
<!--                                    return false;-->
<!--                                }-->
<!--                                if (quantity < 0) {-->
<!--                                    document.getElementById('errorQuantity').innerHTML = `Số lượng phải lớn hơn hoặc bằng 0`-->
<!--                                    return false;-->
<!--                                }-->
<!--                                if (Number.isInteger(quantity)) {-->
<!--                                    document.getElementById('errorQuantity').innerHTML = `Số lượng phải là số nguyên`-->
<!--                                    return false;-->
<!--                                }-->
<!--                                return true;-->
<!--                            }-->


<!--                            checkPrice = () => {-->
<!--                                let isPrice = document.getElementById('price').value-->
<!--                                if (isPrice.trim() === '') {-->
<!--                                    document.getElementById('errorPrice').innerHTML = `Chưa nhập giá`-->
<!--                                    return false;-->
<!--                                }-->
<!--                                if (isPrice < 0) {-->
<!--                                    document.getElementById('errorPrice').innerHTML = `Giá phải lớn hơn hoặc bằng 0`-->
<!--                                    return false;-->
<!--                                }-->
<!--                                if (isPrice > 2147483647) {-->
<!--                                    document.getElementById('errorPrice').innerHTML = `Mức giá quá lớn vui lòng nhập lại`-->
<!--                                    return false;-->
<!--                                }-->
<!--                                return true;-->
<!--                            }-->

<!--                            validate = () => {-->
<!--                                let isQuantity = checkQuantity();-->
<!--                                let isPrice = checkPrice();-->
<!--                                if (isQuantity === true && isPrice === true) {-->
<!--                                    return true;-->
<!--                                }-->
<!--                            }-->

<!--                            checkName = (attributeName, errorAttributeName, title) => {-->
<!--                                debugger-->
<!--                                let isName = document.getElementById(attributeName).value-->
<!--                                if (isName.trim() === '') {-->
<!--                                    document.getElementById(errorAttributeName).innerHTML = `Chưa nhập ${title}`-->
<!--                                    return false;-->
<!--                                }-->
<!--                                return true;-->
<!--                            }-->

<!--                            clickAttribute = (entity, idForm, attributeName, errorAttributeName, title) => {-->
<!--                                if (checkName(attributeName, errorAttributeName, title)) {-->
<!--                                    Swal.fire({-->
<!--                                        title: "Thêm dữ liệu",-->
<!--                                        text: "Bạn có muốn thêm dữ liệu không ?",-->
<!--                                        icon: "question",-->
<!--                                        showCancelButton: true,-->
<!--                                        confirmButtonColor: "#0DC149",-->
<!--                                        cancelButtonColor: "#d33",-->
<!--                                        confirmButtonText: "Có",-->
<!--                                        cancelButtonText: "Không",-->
<!--                                        allowOutsideClick: false-->
<!--                                    }).then((add) => {-->
<!--                                        if (add.isConfirmed) {-->
<!--                                            document.getElementById(idForm).action = '/nova/' + entity + '/attribute'-->
<!--                                            document.getElementById(idForm).method = 'post'-->
<!--                                            document.getElementById(idForm).submit()-->
<!--                                        }-->
<!--                                    });-->
<!--                                }-->
<!--                            }-->

<!--                            updateProductDetail = () => {-->
<!--                                if (validate()) {-->
<!--                                    Swal.fire({-->
<!--                                        title: "Sửa dữ liệu",-->
<!--                                        text: "Bạn có muốn sửa dữ liệu không ?",-->
<!--                                        icon: "question",-->
<!--                                        showCancelButton: true,-->
<!--                                        confirmButtonColor: "#0DC149",-->
<!--                                        cancelButtonColor: "#d33",-->
<!--                                        confirmButtonText: "Có",-->
<!--                                        cancelButtonText: "Không",-->
<!--                                        allowOutsideClick: false-->
<!--                                    }).then((update) => {-->
<!--                                        if (update.isConfirmed) {-->
<!--                                            document.getElementById('productDetailUpdate').submit()-->
<!--                                        }-->
<!--                                    });-->
<!--                                }-->
<!--                            }-->
<!--                        </script>-->
<!--                        <a th:href="@{|/nova/product/*{product.id}/product-detail|}">-->
<!--                            <button type="button" class="btn btn-warning"><i-->
<!--                                    class="fa-solid fa-circle-left px-4"></i>-->
<!--                            </button>-->
<!--                        </a>-->
<!--                    </div>-->
<!--                </form>-->

<!--                &lt;!&ndash;Color Add Start&ndash;&gt;-->
<!--                <form id="colorForm">-->
<!--                    <div class="modal fade" id="exampleModalColor" tabindex="-1" role="dialog"-->
<!--                         aria-labelledby="exampleModalLabel" aria-hidden="true">-->
<!--                        <div class="modal-dialog" role="document">-->
<!--                            <div class="modal-content">-->
<!--                                <div class="modal-header">-->
<!--                                    <h5 class="modal-title" id="exampleModalLabelColor">Thêm dữ liệu</h5>-->
<!--                                    <button type="button" class="close" data-dismiss="modal"-->
<!--                                            aria-label="Close">-->
<!--                                        <span aria-hidden="true">&times;</span>-->
<!--                                    </button>-->
<!--                                </div>-->
<!--                                <div class="modal-body">-->
<!--                                    <input type="hidden" th:value="*{id}" name="productDetailId">-->
<!--                                    <div class="mb-3">-->
<!--                                        <div class="d-flex justify-content-between">-->
<!--                                            <label class="font-weight-bold form-control-label">Tên màu sắc</label>-->
<!--                                            <div class="" style="color: red" id="errorColorName"></div>-->
<!--                                        </div>-->
<!--                                        <input type="text" id="colorName" name="colorName"-->
<!--                                               class="form-control" oninput="onInputText('errorColorName')">-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="modal-footer">-->
<!--                                    <button onclick="clickAttribute('color', 'colorForm', 'colorName', 'errorColorName', 'tên màu sắc')"-->
<!--                                            type="button" class="btn btn-dark"><i-->
<!--                                            class="fa-solid fa-square-plus px-4"></i></button>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </form>-->
<!--                &lt;!&ndash;Size Add Start&ndash;&gt;-->

<!--                &lt;!&ndash;Size Add Start&ndash;&gt;-->
<!--                <form id="sizeForm" th:object="${productDetail}">-->
<!--                    <div class="modal fade" id="exampleModalSize" tabindex="-1" role="dialog"-->
<!--                         aria-labelledby="exampleModalLabel" aria-hidden="true">-->
<!--                        <div class="modal-dialog" role="document">-->
<!--                            <div class="modal-content">-->
<!--                                <div class="modal-header">-->
<!--                                    <h5 class="modal-title" id="exampleModalLabelSize">Thêm dữ liệu</h5>-->
<!--                                    <button type="button" class="close" data-dismiss="modal"-->
<!--                                            aria-label="Close">-->
<!--                                        <span aria-hidden="true">&times;</span>-->
<!--                                    </button>-->
<!--                                </div>-->
<!--                                <div class="modal-body">-->
<!--                                    <input type="hidden" th:value="*{id}" name="productDetailId">-->
<!--                                    <div class="mb-3">-->
<!--                                        <div class="d-flex justify-content-between">-->
<!--                                            <label class="font-weight-bold form-control-label">Tên kích cỡ</label>-->
<!--                                            <div class="" style="color: red" id="errorSizeName"></div>-->
<!--                                        </div>-->
<!--                                        <input type="text" id="sizeName" name="sizeName"-->
<!--                                               class="form-control" oninput="onInputText('errorSizeName')">-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="modal-footer">-->
<!--                                    <button onclick="clickAttribute('size', 'sizeForm', 'sizeName', 'errorSizeName', 'tên kích cỡ')"-->
<!--                                            type="button" class="btn btn-dark"><i-->
<!--                                            class="fa-solid fa-square-plus px-4"></i></button>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </form>-->
<!--                &lt;!&ndash;Size Add Start&ndash;&gt;-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->
<!--</body>-->
<!--</html>-->

